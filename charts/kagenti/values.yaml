# Global settings
openshift: true

# ------------------------------------------------------------------
#  Control Panel: Enable or disable components here
# ------------------------------------------------------------------
components:
  agentNamespaces:
    enabled: true
  mcpGateway:
    enabled: true
  agentOperator:
    enabled: true
  platformWebhook:
    enabled: true
  ui:
    enabled: true
  istio:
    enabled: true

# Secrets â€” override via a .secrets.yaml file or --set secrets.<key>=<value>.
# githubUser/githubToken are optional: only needed to deploy agents/tools from
# private GitHub repos or pull images from private registries.
secrets:
  githubUser: ""
  githubToken: ""
  openaiApiKey: ""
  slackBotToken: ""
  adminSlackBotToken: ""
  quayUser: ""
  quayToken: ""

common:
  kubectlImage: "quay.io/kubestellar/kubectl:1.30.14"

# ------------------------------------------------------------------
#  Components Configurations
# ------------------------------------------------------------------

# ------------------------------------------------------------------
#  Agents Namespaces
# ------------------------------------------------------------------
agentNamespaces:
- team1
- team2

# ------------------------------------------------------------------
#  UI Configuration
# ------------------------------------------------------------------
ui:
  configmap: kagenti-ui-config
  # Domain name for constructing service URLs (non-OpenShift only)
  domainName: localtest.me
  auth:
    enabled: true
  namespace: kagenti-system
  hostname: kagenti-ui.localtest.me
  url: http://kagenti-ui.localtest.me:8080
  # Frontend (UI v2) configuration
  frontend:
    image: ghcr.io/kagenti/kagenti/ui-v2
    tag: v0.5.0-alpha.7
    resources:
      limits:
        cpu: 100m
        memory: 128Mi
      requests:
        cpu: 25m
        memory: 64Mi
  # Backend API external access
  api:
    hostname: kagenti-api.localtest.me
  # Backend configuration
  backend:
    image: ghcr.io/kagenti/kagenti/backend
    tag: v0.5.0-alpha.7
    resources:
      limits:
        cpu: 250m
        memory: 256Mi
      requests:
        cpu: 50m
        memory: 128Mi

# ------------------------------------------------------------------
#  UI OAuth Secret Creator Configuration
# ------------------------------------------------------------------
uiOAuthSecret:
  # image: ghcr.io/kagenti/kagenti/ui-oauth-secret
  image: quay.io/pdettori/ui-oauth-secret
  tag: latest
  # When true, mount the in-cluster serviceaccount CA
  # into the ui-oauth-secret job via the SSL_CERT_FILE environment variable.
  # When false, the serviceaccount CA is only for the API server
  # and will usually not validate external OpenShift route certificates.
  useServiceAccountCA: true

# ------------------------------------------------------------------
#  Agent OAuth Secret Creator Configuration
# ------------------------------------------------------------------
agentOAuthSecret:
  image: ghcr.io/kagenti/kagenti/agent-oauth-secret
  tag: latest
  # When true, mount the in-cluster serviceaccount CA
  # into the agent-oauth-secret job via the SSL_CERT_FILE environment variable.
  # When false, the serviceaccount CA is only for the API server
  # and will usually not validate external OpenShift route certificates.
  useServiceAccountCA: false
  spiffePrefix: spiffe://localtest.me/sa
  updateEnvConfigMaps: true
  clientName: kagenti-keycloak-client

# ------------------------------------------------------------------
#  API OAuth Secret Creator Configuration
#  Creates a confidential client for programmatic API access via
#  Client Credentials Grant. The credentials are stored in a K8s secret.
#  WARNING: This is a shared credential for testing/dev only.
# ------------------------------------------------------------------
apiOAuthSecret:
  enabled: false
  image: ghcr.io/kagenti/kagenti/api-oauth-secret
  tag: latest
  # Client ID for the API service account
  clientId: kagenti-api
  # Name of the K8s secret to store credentials
  secretName: kagenti-api-oauth-secret
  # Realm role to assign to the service account
  serviceAccountRole: kagenti-operator
  # When true, use the in-cluster serviceaccount CA for SSL verification
  useServiceAccountCA: false

# ------------------------------------------------------------------
#  Keycloak Configuration
# ------------------------------------------------------------------
keycloak:
  enabled: true
  namespace: keycloak
  adminSecretName: keycloak-initial-admin
  adminUsernameKey: username
  adminPasswordKey: password
  url: http://keycloak-service.keycloak:8080
  publicUrl: http://keycloak.localtest.me:8080
  realm: master

# ------------------------------------------------------------------
#  Kagenti Operator Configuration
# ------------------------------------------------------------------
kagenti-operator-chart:
  controllerManager:
    container:
      image:
        tag: 0.2.0-alpha.20
      args:
      - "--leader-elect"
      - "--metrics-bind-address=:8443"
      - "--health-probe-bind-address=:8081"
      - "--webhook-cert-path=/tmp/k8s-webhook-server/serving-certs"
      resources:
        limits:
          cpu: 150m
          memory: 256Mi
        requests:
          cpu: 50m
          memory: 128Mi

# ------------------------------------------------------------------
#  MCP Gateway Configuration
# ------------------------------------------------------------------
mcpGateway:
  namespaces:
    mcpSystem: mcp-system
    gatewaySystem: gateway-system
  # TODO: Investigate why only the hostname 'mcp.127-0-0-1.sslip.io' works for MCP Gateway.
  # Observed behavior: When using this hostname, the MCP Gateway is accessible and functions as expected.
  # Other values tried:  'mcp.localtest.me', and 'mcp.sslip.io' were tested but failed to route traffic correctly.
  # Expected behavior: The MCP Gateway should work with any valid hostname or IP address configured for local development.
  hostname: 'mcp.127-0-0-1.sslip.io'

# ------------------------------------------------------------------
#  Phoenix Configuration
# ------------------------------------------------------------------
phoenix:
  namespace: kagenti-system
  # Domain name for constructing service URLs (non-OpenShift only)
  url: http://phoenix.localtest.me:8080
  auth:
    # Enable Keycloak OAuth2 authentication for Phoenix dashboard
    enabled: true

# ------------------------------------------------------------------
#  Phoenix OAuth Secret Creator Configuration
# ------------------------------------------------------------------
phoenixOAuthSecret:
  image: ghcr.io/kagenti/kagenti/phoenix-oauth-secret
  tag: latest
  # Keycloak client ID for Phoenix
  clientId: phoenix
  # Kubernetes secret name to store OAuth credentials
  secretName: phoenix-oauth-secret
  # When true, mount the in-cluster serviceaccount CA
  # into the phoenix-oauth-secret job via the SSL_CERT_FILE environment variable.
  useServiceAccountCA: true

# ------------------------------------------------------------------
#  MLflow Configuration
# ------------------------------------------------------------------
mlflow:
  namespace: kagenti-system
  # Domain name for constructing service URLs (non-OpenShift only)
  url: http://mlflow.localtest.me:8080
  auth:
    # Enable Keycloak OAuth2 authentication for MLflow
    # Set to true in ocp_values.yaml for production deployments
    enabled: false
    # Kubernetes secret name containing OAuth credentials
    secretName: mlflow-oauth-secret

# ------------------------------------------------------------------
#  MLflow OAuth Secret Creator Configuration
# ------------------------------------------------------------------
# TODO: Change back to ghcr.io/kagenti/kagenti/mlflow-oauth-secret once
# the image is published via Build-Publish workflow (on version tag)
mlflowOAuthSecret:
  image: quay.io/ladas/mlflow-oauth-secret
  tag: latest
  # Keycloak client ID for MLflow
  clientId: mlflow
  # Kubernetes secret name to store OAuth credentials
  secretName: mlflow-oauth-secret
  # When true, mount the in-cluster serviceaccount CA
  # into the mlflow-oauth-secret job via the SSL_CERT_FILE environment variable.
  useServiceAccountCA: true

# ------------------------------------------------------------------
#  Spiffe/Spire configs
# ------------------------------------------------------------------
spire:
  enabled: true
